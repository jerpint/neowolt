{"id":"mlyczw70-fc305b","type":"chat","title":"Vim Synth","timestamp":"2026-02-22T23:08:39.228Z","html":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\">\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<title>Vim Synth</title>\n<style>\n  body {\n    margin: 0;\n    padding: 20px;\n    background: #0d1117;\n    color: #c9d1d9;\n    font-family: 'Courier New', monospace;\n    overflow: hidden;\n  }\n  #container {\n    max-width: 1200px;\n    margin: 0 auto;\n  }\n  #status {\n    padding: 10px;\n    background: #161b22;\n    border: 1px solid #30363d;\n    margin-bottom: 20px;\n    font-size: 14px;\n  }\n  .mode {\n    color: #58a6ff;\n    font-weight: bold;\n  }\n  #keyboard {\n    display: grid;\n    grid-template-columns: repeat(16, 1fr);\n    gap: 4px;\n    margin-bottom: 20px;\n  }\n  .key {\n    aspect-ratio: 1;\n    background: #161b22;\n    border: 2px solid #30363d;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 18px;\n    font-weight: bold;\n    transition: all 0.1s;\n  }\n  .key.active {\n    background: #58a6ff;\n    border-color: #58a6ff;\n    color: #0d1117;\n    box-shadow: 0 0 20px #58a6ff;\n  }\n  .key.cursor {\n    border-color: #f85149;\n    box-shadow: 0 0 10px #f85149;\n  }\n  #waveform {\n    width: 100%;\n    height: 200px;\n    background: #161b22;\n    border: 1px solid #30363d;\n  }\n  #help {\n    margin-top: 20px;\n    padding: 10px;\n    background: #161b22;\n    border: 1px solid #30363d;\n    font-size: 12px;\n    line-height: 1.6;\n  }\n  .cmd {\n    color: #79c0ff;\n  }\n</style>\n</head>\n<body>\n<div id=\"container\">\n  <div id=\"status\">\n    <span class=\"mode\">NORMAL</span> | Cursor: <span id=\"pos\">0,0</span> | Playing: <span id=\"notes\">-</span>\n  </div>\n  \n  <div id=\"keyboard\"></div>\n  \n  <canvas id=\"waveform\"></canvas>\n  \n  <div id=\"help\">\n    <strong>VIM SYNTH</strong><br>\n    <span class=\"cmd\">hjkl</span> - move cursor | <span class=\"cmd\">i</span> - INSERT mode (play note) | <span class=\"cmd\">ESC</span> - NORMAL mode<br>\n    <span class=\"cmd\">x</span> - delete/stop note | <span class=\"cmd\">v</span> - VISUAL mode (select region) | <span class=\"cmd\">y</span> - yank (copy) | <span class=\"cmd\">p</span> - paste<br>\n    <span class=\"cmd\">dd</span> - delete row | <span class=\"cmd\">gg</span> - go to start | <span class=\"cmd\">G</span> - go to end<br>\n    <span class=\"cmd\">w</span> - next note | <span class=\"cmd\">b</span> - prev note | <span class=\"cmd\">u</span> - undo | <span class=\"cmd\">.</span> - repeat\n  </div>\n</div>\n\n<script>\nconst audioCtx = new (window.AudioContext || window.webkitAudioContext)();\nconst WIDTH = 16;\nconst HEIGHT = 8;\nconst notes = ['C4', 'D4', 'E4', 'F4', 'G4', 'A4', 'B4', 'C5', 'D5', 'E5', 'F5', 'G5', 'A5', 'B5', 'C6', 'D6'];\n\nconst noteFreq = {\n  'C4': 261.63, 'D4': 293.66, 'E4': 329.63, 'F4': 349.23,\n  'G4': 392.00, 'A4': 440.00, 'B4': 493.88, 'C5': 523.25,\n  'D5': 587.33, 'E5': 659.25, 'F5': 698.46, 'G5': 783.99,\n  'A5': 880.00, 'B5': 987.77, 'C6': 1046.50, 'D6': 1174.66\n};\n\nlet mode = 'NORMAL';\nlet cursorX = 0;\nlet cursorY = 0;\nlet grid = Array(HEIGHT).fill().map(() => Array(WIDTH).fill(false));\nlet oscillators = {};\nlet visualMode = false;\nlet visualStart = null;\nlet clipboard = [];\nlet lastCmd = '';\nlet cmdBuffer = '';\n\nconst keyboard = document.getElementById('keyboard');\nconst statusMode = document.querySelector('.mode');\nconst statusPos = document.getElementById('pos');\nconst statusNotes = document.getElementById('notes');\nconst canvas = document.getElementById('waveform');\nconst ctx = canvas.getContext('2d');\n\ncanvas.width = canvas.offsetWidth;\ncanvas.height = 200;\n\n// Create keyboard grid\nfor (let y = 0; y < HEIGHT; y++) {\n  for (let x = 0; x < WIDTH; x++) {\n    const key = document.createElement('div');\n    key.className = 'key';\n    key.textContent = notes[x];\n    key.dataset.x = x;\n    key.dataset.y = y;\n    keyboard.appendChild(key);\n  }\n}\n\nfunction updateDisplay() {\n  document.querySelectorAll('.key').forEach(key => {\n    const x = parseInt(key.dataset.x);\n    const y = parseInt(key.dataset.y);\n    key.classList.toggle('active', grid[y][x]);\n    key.classList.toggle('cursor', x === cursorX && y === cursorY);\n  });\n  \n  statusMode.textContent = mode + (visualMode ? ' VISUAL' : '');\n  statusPos.textContent = `${cursorY},${cursorX}`;\n  \n  const playing = Object.keys(oscillators).join(', ') || '-';\n  statusNotes.textContent = playing;\n}\n\nfunction playNote(x, y) {\n  const key = `${x},${y}`;\n  if (oscillators[key]) return;\n  \n  const osc = audioCtx.createOscillator();\n  const gain = audioCtx.createGain();\n  \n  osc.type = 'sine';\n  osc.frequency.value = noteFreq[notes[x]];\n  gain.gain.value = 0.2;\n  \n  osc.connect(gain);\n  gain.connect(audioCtx.destination);\n  osc.start();\n  \n  oscillators[key] = { osc, gain };\n  grid[y][x] = true;\n}\n\nfunction stopNote(x, y) {\n  const key = `${x},${y}`;\n  if (!oscillators[key]) return;\n  \n  oscillators[key].osc.stop();\n  delete oscillators[key];\n  grid[y][x] = false;\n}\n\nfunction stopAll() {\n  Object.keys(oscillators).forEach(key => {\n    oscillators[key].osc.stop();\n  });\n  oscillators = {};\n  grid = Array(HEIGHT).fill().map(() => Array(WIDTH).fill(false));\n}\n\n// Waveform visualization\nfunction drawWaveform() {\n  ctx.fillStyle = '#161b22';\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n  \n  const playing = Object.values(oscillators);\n  if (playing.length === 0) {\n    requestAnimationFrame(drawWaveform);\n    return;\n  }\n  \n  ctx.strokeStyle = '#58a6ff';\n  ctx.lineWidth = 2;\n  ctx.beginPath();\n  \n  const time = audioCtx.currentTime;\n  for (let i = 0; i < canvas.width; i++) {\n    const t = (i / canvas.width) * 0.1;\n    let y = 0;\n    \n    playing.forEach(({ osc }) => {\n      y += Math.sin(2 * Math.PI * osc.frequency.value * t) * 0.3;\n    });\n    \n    const canvasY = canvas.height / 2 + y * canvas.height / 2;\n    \n    if (i === 0) ctx.moveTo(i, canvasY);\n    else ctx.lineTo(i, canvasY);\n  }\n  \n  ctx.stroke();\n  requestAnimationFrame(drawWaveform);\n}\n\ndrawWaveform();\n\n// Vim keybindings\ndocument.addEventListener('keydown', (e) => {\n  if (e.key === 'Escape') {\n    mode = 'NORMAL';\n    visualMode = false;\n    cmdBuffer = '';\n    updateDisplay();\n    return;\n  }\n  \n  if (mode === 'INSERT') {\n    if (e.key === 'Escape') {\n      mode = 'NORMAL';\n    } else {\n      playNote(cursorX, cursorY);\n      cursorX = (cursorX + 1) % WIDTH;\n    }\n    updateDisplay();\n    return;\n  }\n  \n  // NORMAL mode\n  cmdBuffer += e.key;\n  \n  // Motion commands\n  if (e.key === 'h') { cursorX = Math.max(0, cursorX - 1); cmdBuffer = ''; }\n  else if (e.key === 'l') { cursorX = Math.min(WIDTH - 1, cursorX + 1); cmdBuffer = ''; }\n  else if (e.key === 'j') { cursorY = Math.min(HEIGHT - 1, cursorY + 1); cmdBuffer = ''; }\n  else if (e.key === 'k') { cursorY = Math.max(0, cursorY - 1); cmdBuffer = ''; }\n  else if (e.key === 'w') { cursorX = Math.min(WIDTH - 1, cursorX + 1); cmdBuffer = ''; }\n  else if (e.key === 'b') { cursorX = Math.max(0, cursorX - 1); cmdBuffer = ''; }\n  else if (cmdBuffer === 'gg') { cursorX = 0; cursorY = 0; cmdBuffer = ''; }\n  else if (e.key === 'G') { cursorY = HEIGHT - 1; cmdBuffer = ''; }\n  \n  // Mode changes\n  else if (e.key === 'i') { mode = 'INSERT'; cmdBuffer = ''; }\n  else if (e.key === 'v') { visualMode = !visualMode; visualStart = {x: cursorX, y: cursorY}; cmdBuffer = ''; }\n  \n  // Edit commands\n  else if (e.key === 'x') { stopNote(cursorX, cursorY); lastCmd = 'x'; cmdBuffer = ''; }\n  else if (cmdBuffer === 'dd') { \n    for (let x = 0; x < WIDTH; x++) stopNote(x, cursorY); \n    lastCmd = 'dd'; cmdBuffer = '';\n  }\n  else if (e.key === 'y' && visualMode) {\n    clipboard = [];\n    const x1 = Math.min(cursorX, visualStart.x);\n    const x2 = Math.max(cursorX, visualStart.x);\n    const y1 = Math.min(cursorY, visualStart.y);\n    const y2 = Math.max(cursorY, visualStart.y);\n    for (let y = y1; y <= y2; y++) {\n      for (let x = x1; x <= x2; x++) {\n        clipboard.push(grid[y][x]);\n      }\n    }\n    visualMode = false;\n    cmdBuffer = '';\n  }\n  else if (e.key === 'p') {\n    let idx = 0;\n    for (let y = cursorY; y < HEIGHT && idx < clipboard.length; y++) {\n      for (let x = cursorX; x < WIDTH && idx < clipboard.length; x++) {\n        if (clipboard[idx]) playNote(x, y);\n        idx++;\n      }\n    }\n    cmdBuffer = '';\n  }\n  else if (e.key === '.') {\n    // Repeat last command (simplified)\n    if (lastCmd === 'x') stopNote(cursorX, cursorY);\n    cmdBuffer = '';\n  }\n  else if (e.key === 'u') {\n    stopAll();\n    cmdBuffer = '';\n  }\n  \n  // Clear buffer if it gets too long\n  if (cmdBuffer.length > 2) cmdBuffer = '';\n  \n  updateDisplay();\n});\n\nupdateDisplay();\n</script>\n</body>\n</html>"}